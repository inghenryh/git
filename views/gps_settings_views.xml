<odoo>
    <!-- Vista del formulario de configuración -->
    <record id="view_gps_settings_form" model="ir.ui.view">
        <field name="name">gps.settings.form</field>
        <field name="model">evisiongps.settings</field>
        <field name="arch" type="xml">
            <form string="Configuración de e-Vision GPS">
                <sheet>
                    <group>
                        <field name="email"/>
                        <field name="password" password="True"/>
                        <button string="Probar Conexión" type="object" name="test_connection" class="btn-primary"/>
                    </group>
                    <group>
                        <field name="connection_status" widget="statusbar" options="{'clickable': False}"/>
                        <field name="user_api_hash" readonly="1"/>
                        <field name="active" invisible="1"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Vista de lista para mostrar conexiones previas -->
    <record id="view_gps_settings_tree" model="ir.ui.view">
        <field name="name">gps.settings.tree</field>
        <field name="model">evisiongps.settings</field>
        <field name="arch" type="xml">
            <tree>
                <field name="email"/>
                <field name="connection_status"/>
                <field name="user_api_hash"/>
                <field name="active"/>
            </tree>
        </field>
    </record>

    <!-- Acción para abrir la vista de configuración -->
    <record id="action_evisiongps_settings" model="ir.actions.act_window">
        <field name="name">Configuración de e-Vision GPS</field>
        <field name="res_model">evisiongps.settings</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_gps_settings_form"/>
        <field name="target">current</field>
        <field name="domain">[('active', '=', True)]</field>
    </record>

    <!-- Menú para acceder a la configuración -->
    <menuitem id="menu_evisiongps_settings"
              name="Configuración GPS"
              parent="fleet.menu_root"
              action="action_evisiongps_settings"
              sequence="20"/>
</odoo>
